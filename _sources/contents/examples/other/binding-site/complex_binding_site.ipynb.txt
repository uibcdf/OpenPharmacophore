{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2ecf4905-105a-421a-85ce-8f7028849fde",
   "metadata": {},
   "source": [
    "# Binding site of a protein-ligand complex\n",
    "\n",
    "In this notebook we explore the binding site of two different protein ligand-complexes.\n",
    "\n",
    "We'll start by loading the complexes structures from a pdb file. We then proceed to prepare the ligand and the \n",
    "protein so we can extract and visualize the binding site of the protein"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3e989c61-d59b-429d-8fbe-c971396e2026",
   "metadata": {
    "tags": [
     "remove-output"
    ]
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "7433e5c590034cf0ae91ef9ae815f702",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import openpharmacophore as oph"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ba7f112-fb57-4af2-931d-60089a027068",
   "metadata": {},
   "source": [
    "## PDB 3BBH\n",
    "\n",
    "We start with the structure with PDB ID 3BBH. This file was already pretreated, so the protein contains hydrogens, and there is only\n",
    "a single chain."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "94a31c7a-b3b5-4b01-95f4-dc2a7278c334",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Has hydrogens: <bound method Protein.has_hydrogens of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe2332db790>>\n",
      "Has ligand: <bound method Protein.has_ligands of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe2332db790>>\n"
     ]
    }
   ],
   "source": [
    "protein = oph.load(\"../../data/3bbh_hyd.pdb\")\n",
    "print(f\"Has hydrogens: {protein.has_hydrogens}\")\n",
    "print(f\"Has ligand: {protein.has_ligands}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8fae8f3-6c9d-4b2a-b2d8-cafc359a2400",
   "metadata": {},
   "source": [
    "A protein may contain one or multiple ligands. To extract one we need to know its id. We can view\n",
    "the id of all the ligans in the protein by calling the attribute ```ligand_ids```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2e4c9085-e39b-4062-b1bc-acb5712abef5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['SFG:B']\n"
     ]
    }
   ],
   "source": [
    "lig_ids = protein.ligand_ids()\n",
    "print(lig_ids)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "8cb67a66-5f17-4be7-9b7c-9d86ae72930d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<rdkit.Chem.rdchem.Mol at 0x7fe28d550e40>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ligand = protein.get_ligand(lig_ids[0])\n",
    "ligand.draw()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a695e9c-62e1-49cb-99d1-05a2db71a440",
   "metadata": {},
   "source": [
    "We fix the ligand. Its bond orders are correct now"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "de6f02f7-59e1-41d3-a611-cb37576189ee",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[16:54:42] WARNING: More than one matching pattern found - picking one\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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j5eXV8OGDbliqq+v7+Li8sGKJpFIrKysAFy9epVfDqWlpT179ty0aZPijYGjo6O5g6ysrGfPnvE7r/bJy8szMzNT5c8iOjrawMBAIBBoqNL93//9H4DOnTtrIvjnhpVR5axcuTI8PJyInj17xq1BUQsfHx8jIyMADg4OsbGx3BelUmlwcLCLi4tIJOLqafv27cVicUFBwTuDHDp0CECbNm14pyEWiwE0aNBA3ufpgwYNGsQdBAQE7Nixg/eptc+KFSsAtG7dWiwWnzx5MjQ09OHDhwpeWBQVFbVp0waA5vY9fvnypYWFBYDQ0FANneLzwcqoclauXLlhw4bff/9979696imjL1/O+eYbrkrOmjXrnX3PYmNjly1bVrNmTe5jtWrVWrZsWXx8/Bsf425l7t69m18ieXl5tWvXBnDs2DHFR2lHGY17velKXl7eC9W3/iAiopiYGAsLC319/bfvpJmZmbVo0aJbt25Dhw51c3NbtWqVl5eXj49PQEBARERESkrK4sWLuVs6+fn5aknmnbi3oZydnTV3is8EK6PKWbly5bZt286fP3/kyJGpU6f6+fn5+fkp2PPxHR4+pNatAzt2rFat2gdvERQVFfn4+LRt25b7pygUCvv16xcQEMB1Bb19+zaAGjVqvHz5kl8uS5YsAdC1a1el2owOGjTI3d3d3d190KBBn24ZdXZ25vrJnz59etu2bWqJuXHjRq4UzpgxY8SIEV27dm3atKmpYh1iTExMdHR0wsLC1JLJ+2RmZpqYmPTv35//X2CGiIhYaxKlderUqWPHjmlpaWfPnl2xYkVCQsKiRYumTZs2c+bM+kr1tTt4EDNn4tWroS1bPo2IsKiwtQQAfX39yZMnT548+e+//969e7efn9+FCxcuXLjQpEmTGTNm3Lt3D8C0adOMeb0y/fTp061btwqFwi1btggEAqXGent7AwgMDExKSuJxaq1ERLt37wawZcuWIUOGlP9WcXEx140pIyMjIyPjxYsXz58/f/78ubxL07NnzwoLCxs3bty5c2eNJmlubn727FmBQMBNmffv3z99+nSNnlFrVXYd/8T4+fk9evSIiLKysjZu3Lh3714HBwfud1IkEo0cOTL58mX64GyuqIjmzy9rQz9pEvGaP6alpf34449169blzs7VPt6PI7788ksA05XfR087LuqdnZ25OfXgwYPV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\n",
      "text/plain": [
       "<rdkit.Chem.rdchem.Mol at 0x7fe28d78e030>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ligand.fix_bond_order(\n",
    "        smiles=\"c1nc(c2c(n1)n(cn2)[C@H]3[C@@H]([C@@H]([C@H](O3)C[C@H](CC[C@@H](C(=O)O)N)N)O)O)N\"\n",
    ")\n",
    "ligand.draw()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0adf324c-9e4c-4507-a970-03816fe20c50",
   "metadata": {},
   "source": [
    "Now we can remove the ligand from the protein"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "52f9c758-ba80-4cf7-98c3-363b7cf9daa8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Has ligand: <bound method Protein.has_ligands of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe2332db790>>\n"
     ]
    }
   ],
   "source": [
    "protein.remove_ligand(lig_ids[0])\n",
    "print(f\"Has ligand: {protein.has_ligands}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4103e07c-05c7-40c4-ad7f-bcc6fd92d0f4",
   "metadata": {},
   "source": [
    "We create a binding site to obtain the receptor chemical features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "25ae3980-b3e8-4255-a915-2b22c72c99c8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found 492 chemical features in receptor\n",
      "Found 20 chemical features in ligand\n"
     ]
    }
   ],
   "source": [
    "bsite = oph.ComplexBindingSite(protein, ligand)\n",
    "\n",
    "# Extract chemical features and visualize them\n",
    "receptor_feats = bsite.get_chem_feats(frame=0)\n",
    "ligand_feats = ligand.get_chem_feats(conf_ind=0)\n",
    "\n",
    "print(f\"Found {len(receptor_feats)} chemical features in receptor\")\n",
    "print(f\"Found {len(ligand_feats)} chemical features in ligand\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "663b6e9a-f34d-40e5-a0f8-ccde29ddc806",
   "metadata": {},
   "source": [
    "Finally we visualize the binding site with the chemical"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "da4de4f8-d82a-4a55-9006-f111f26b5d9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "viewer = oph.Viewer()\n",
    "viewer.add_components([bsite, ligand, ligand_feats])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "491b625c-e730-4451-9d20-1bd9de62ae94",
   "metadata": {
    "tags": [
     "remove-output"
    ]
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "c236439e29904bc7a678d41cb828f9bc",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "NGLWidget()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "view = viewer.show()\n",
    "viewer.set_protein_style(\"ball+stick\")\n",
    "view"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf1ae74c-97e1-4248-8201-6a8df47aa287",
   "metadata": {},
   "source": [
    "<img src=\"../../../../_static/bsite_3bbh.png\" alt=\"pharmacophore\">"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1be7bede-c9dc-40ac-bca1-379b3ba4bcde",
   "metadata": {},
   "source": [
    "## PDB 1M7W"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "39e42a02-15b2-4af9-aade-adccb0e8cc8f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Has hydrogens: <bound method Protein.has_hydrogens of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe232f37dd0>>\n",
      "Has ligand: <bound method Protein.has_ligands of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe232f37dd0>>\n"
     ]
    }
   ],
   "source": [
    "protein_2 = oph.load(\"../../data/1m7w_A_chain.pdb\")\n",
    "print(f\"Has hydrogens: {protein_2.has_hydrogens}\")\n",
    "print(f\"Has ligand: {protein_2.has_ligands}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "4d261788-628a-4526-83e4-a1154cb5ea98",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['DAO:B']\n"
     ]
    }
   ],
   "source": [
    "lig_ids = protein_2.ligand_ids()\n",
    "print(lig_ids)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a1e98f3f-bde5-45cd-8209-7607d741a0fb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<rdkit.Chem.rdchem.Mol at 0x7fe28d50fbc0>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ligand_2 = protein_2.get_ligand(lig_ids[0])\n",
    "ligand_2.draw()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "74373e02-55f4-4cdd-bd3d-5654204ba216",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[16:54:43] WARNING: More than one matching pattern found - picking one\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<rdkit.Chem.rdchem.Mol at 0x7fe28d423ee0>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ligand_2.fix_bond_order(smiles=\"CCCCCCCCCCCC(=O)O\")\n",
    "ligand_2.add_hydrogens()\n",
    "ligand_2.draw()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "733ddd90-5510-4b25-919d-2ad128e8bf7d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Has ligand: <bound method Protein.has_ligands of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe232f37dd0>>\n"
     ]
    }
   ],
   "source": [
    "protein_2.remove_ligand(lig_ids[0])\n",
    "print(f\"Has ligand: {protein_2.has_ligands}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b73eae66-cf0a-437b-be4a-7fdfd917e455",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Has hydrogens: <bound method Protein.has_hydrogens of <openpharmacophore.molecular_systems.protein.Protein object at 0x7fe232f37dd0>>\n"
     ]
    }
   ],
   "source": [
    "protein_2.add_hydrogens()\n",
    "print(f\"Has hydrogens: {protein_2.has_hydrogens}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d8b6e5ae-f4c5-405c-bc06-0205eb308743",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found 652 chemical features in receptor\n",
      "Found 9 chemical features in ligand\n"
     ]
    }
   ],
   "source": [
    "bsite_2 = oph.ComplexBindingSite(protein_2, ligand_2)\n",
    "\n",
    "receptor_feats_2 = bsite_2.get_chem_feats(frame=0)\n",
    "ligand_feats_2 = ligand_2.get_chem_feats(conf_ind=0)\n",
    "\n",
    "print(f\"Found {len(receptor_feats_2)} chemical features in receptor\")\n",
    "print(f\"Found {len(ligand_feats_2)} chemical features in ligand\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "5416f62a-fbc0-4c8a-8225-af620fb8571e",
   "metadata": {},
   "outputs": [],
   "source": [
    "viewer_2 = oph.Viewer()\n",
    "viewer_2.add_components([bsite_2,ligand_2, ligand_feats_2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4f6a3760-eb30-4fdf-8156-51fb81cf8c58",
   "metadata": {
    "tags": [
     "remove-output"
    ]
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "b21fd08dae0b4af0a29f603cc706ff69",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "NGLWidget()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "view_2 = viewer_2.show()\n",
    "viewer_2.set_protein_style(\"ball+stick\")\n",
    "view_2"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a9f5845-4928-445d-add5-4381a40efdf9",
   "metadata": {},
   "source": [
    "<img src=\"../../../../_static/bsite_1m7w.png\" alt=\"pharmacophore\">\n",
    "<div class=\"alert alert-info\">\n",
    "    <strong>Note:</strong>\n",
    "    <p>view and view_2 display an interactive widget. For simplicity an image is presented in the documentation.</p>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "74110d0e-f4a6-49a7-8841-2c2f77bd6dc8",
   "metadata": {
    "tags": [
     "remove-cell"
    ]
   },
   "outputs": [],
   "source": [
    "# Save view image so it can be viewed in the documentation\n",
    " \n",
    "import time\n",
    "import threading\n",
    "\n",
    "save = False\n",
    "\n",
    "def save_image(view):\n",
    "    im = view.render_image()\n",
    "    while not im.value:\n",
    "        time.sleep(0.1)\n",
    "    save_path = \"../../../../_static/bsite_3bbh.png\"\n",
    "    with open(save_path, \"wb\") as fp:\n",
    "        fp.write(im.value)    \n",
    "\n",
    "def generate_image():\n",
    "    thread = threading.Thread(target=save_image, args=(viewer.to_nglview(),), daemon=True)\n",
    "    thread.start()\n",
    "    \n",
    "\n",
    "if save:\n",
    "    generate_image()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
